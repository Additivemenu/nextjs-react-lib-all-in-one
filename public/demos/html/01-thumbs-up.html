<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Thumbs Up Demo</title>
    <style>
      html,
      body {
        font-family: -apple-system, "BlinkMacSystemFont", sans-serif;
        margin: 0;
        height: 100%;
        display: flex;
        justify-content: center;
        flex-direction: column;
        align-items: center;
        background: rgb(0, 0, 0);
        font-size: 40px;
        overflow: hidden;
      }

      body::after {
        content: "ÁÇπÂáªÂ±èÂπï";
        color: rgba(255, 255, 255, 0.2);
        font-size: 1em;
      }

      /**
       * part1 =========================================
       * thumbs up
       */
      .custom-tips {
        position: absolute;
        width: 1em;
        height: 1em;
        margin-left: -0.5em;
        margin-top: -0.5em;
        left: 0;
        top: 0;
        transform: translate(var(--left, 50%), var(--top, 50%));
        border: 1px solid red;
      }

      .custom-tips-dot {
        position: absolute;
        inset: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        opacity: 1;
        outline: 1px solid yellowgreen;
        animation: custom-x 1s var(--d, 0s) linear forwards;
      }
      .custom-tips-dot::before {
        content: attr(emoji, "üéâ");
        animation: custom-y 1s var(--d, 0s)
          cubic-bezier(0.56, -1.35, 0.85, 0.36) forwards;
      }

      @keyframes custom-x {
        0% {
          opacity: 1;
          transform: translateX(0%);
        }
        10%,
        90% {
          opacity: 1;
        }
        100% {
          opacity: 1;
          transform: translateX(var(--x, 300%));
        }
      }

      @keyframes custom-y {
        100% {
          transform: translateY(50vh) rotate(1turn);
        }
      }

      /**
       * part2 =========================================
       * num
      */
      .custom-num {
        position: absolute;
        left: 0;
        top: 0;
        display: flex;
        width: 2em;
        height: 2em;
        font-size: 2em;
        color: #fff;
        justify-content: center;
        align-items: center;
        margin-left: -1em;
        margin-top: -2em;
        font-weight: bold;
        text-shadow: 4px 4px 0 rgba(255, 0, 0);
        transform: translate(var(--left), var(--top));
      }
      .custom-num::before {
        content: "+" attr(num);
        opacity: 0;
        animation: count-shark 1s var(--d, 0s);
      }

      @keyframes count-shark {
        0%,
        100% {
          opacity: 0;
          transform: scale(0.4);
        }

        30%,
        70% {
          opacity: 1;
          transform: scale(1);
        }
      }
    </style>
  </head>
  <body>
    <script>
      // https://mp.weixin.qq.com/s/eR4obTw_qFcu-Tng2dVhDw
      document.addEventListener("click", (ev) => {
        const { clientX, clientY } = ev;

        document.body.style.setProperty("--left", `${clientX}px`);
        document.body.style.setProperty("--top", `${clientY}px`);

        // ÂàõÂª∫‰∏Ä‰∏™ div ÁõíÂ≠ê
        // ËØ•ÁõíÂ≠ê‰∏äÈù¢‰πüÊåÇ‰∏ä --left Âíå --top ‰∏§‰∏™ÂèòÈáè
        const tips = document.createElement("div");
        tips.style.setProperty("--left", `${clientX}px`);
        tips.style.setProperty("--top", `${clientY}px`);
        // ÊåÇ‰∏ä‰∏Ä‰∏™Ê†∑ÂºèÁ±ª
        tips.className = "custom-tips";
        // Ê∑ªÂä†Âà∞È°µÈù¢‰∏ä
        document.body.appendChild(tips);

        const dots = createDots(["üéâ", "üòò", "üéä", "ü§°", "ü•≥", "ü§™", "üíó"]);
        tips.appendChild(dots);

        document.body.appendChild(createNum());
      });

      /**
       *
       * @param {*} emojis
       * @returns
       */
      function createDots(emojis) {
        const temp = document.createDocumentFragment();
        // Ê†∏ÂøÉÂ∞±ÊòØÊñ∞Â¢û‰∫Ü‰∏ãÈù¢ËøôÊÆµÈÄªËæëÔºåÊâì‰π± emoji ÁöÑÈ°∫Â∫è
        const random_emojis = emojis
          .slice(0, Math.ceil(Math.random() * emojis.length))
          .sort(() => Math.random() - 0.5);

        random_emojis.forEach((emoji) => {
          const dot = document.createElement("div");
          dot.className = "custom-tips-dot";
          dot.setAttribute("emoji", emoji);
          dot.style.setProperty("--d", `${Math.random() * 0.2}s`); // ÊØè‰∏™ÁÇπ0 ~ 0.2s ÈöèÊú∫Âª∂ËøüÔºåÈÅøÂÖç"ÂêåÊó∂Ëµ∑Ë∑≥"ÁöÑÊ≠ªÊùøÊÑü„ÄÇ
          dot.style.setProperty("--x", `${(Math.random() - 0.5) * 1000}%`); // ËåÉÂõ¥ (-500% ~ 500%)Ôºå‰πüÂ∞±ÊòØÂêëÂ∑¶/Âè≥ÊúÄÂ§ö 10√ó Ëá™Ë∫´ÂÆΩÂ∫¶ÁöÑ‰ΩçÁßª
          temp.appendChild(dot);

          // Êñ∞Â¢ûÈÄªËæë
          dot.addEventListener("animationend", () => {
            console.log(
              "dot.parentNode",
              dot.parentNode,
              dot.parentNode?.childElementCount,
            );
            if (dot?.parentNode?.childElementCount <= 1) {
              dot.parentNode.remove();
            } else {
              dot.remove();
            }
          });
        });
        return temp;
      }

      /**
       *
       * @returns
       */
      function createNum() {
        const current = document.querySelector(".custom-num");
        let num = 1;
        if (current) {
          num = parseInt(current.getAttribute("num")) + 1; // Êï∞Â≠óÈÄíÂ¢û
          current.remove(); // Â∞ÜÊóßÁöÑÁßªÈô§
        }
        const numDiv = document.createElement("div");
        numDiv.className = "custom-num";
        if (num > 1) {
          numDiv.style.setProperty("--d", "-.3s");
        }
        numDiv.setAttribute("num", num);

        // Êñ∞Â¢ûÈÄªËæë
        numDiv.addEventListener("animationend", () => {
          numDiv.remove();
        });
        return numDiv;
      }
    </script>
  </body>
</html>
